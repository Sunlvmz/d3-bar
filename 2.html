<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
    <style>
        .bar-line {
            fill: #F38630;
        }
        .domain,
        .tick,
        .tick line {
            stroke: #62D2E7;
        }
    </style>
</head>
<body>

<div id="chartContainer"></div>

<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-selection-multi.v1.min.js"></script>
<script>
  // 定义数据
  var data = [
    { value: 99, label: 'Mon' },
    { value: 63, label: 'Tues' },
    { value: 41, label: 'Wed' },
    { value: 100, label: 'Thur' },
    { value: 50, label: 'Fri' },
    { value: 23, label: 'Sat' },
    { value: 8, label: 'Sun' }
  ];

  // 定义参数值
  var dimensions = {
    gWidth: 600,
    gHeight: 400,
    gMargin: 40,
    gInnerWidth: 520,
    gInnerHeight: 320,
    bMargin: 10
  };

  var barWidth = (dimensions.gInnerWidth / data.length) - (dimensions.bMargin * 2 )

  // 获取y轴最大值
  var maxValue = d3.max(data, d => d.value);

  // 定义y轴比例尺
  var yScale = d3.scaleLinear()
    .domain([0, maxValue])
    .range([0, dimensions.gInnerHeight]);


  var yAxisScale = d3.scaleLinear()
    .domain([maxValue, 0])
    .range([0, dimensions.gInnerHeight]);

  // Render the chart
  // Select the containing element and append an SVG with your defined width and height
  var chart = d3.select('#chartContainer')
    .append('svg')
    .attrs({
      width: dimensions.gWidth,
      height: dimensions.gHeight
    });

  // 生成y轴
  var yAxis = d3.axisLeft( yAxisScale )
    .tickSizeInner( -dimensions.gInnerWidth )  // tickSizeInner作用于排除两边刻度的中间刻度的的辅助线，--dimensions.gInnerWidth就可以贯穿整个图横轴
    .tickPadding( 10 );  // y轴刻度文字距离Y轴的距离

  chart.append('g')
    .attr('transform', `translate(${dimensions.gMargin}, ${dimensions.gMargin})`)
    .call(yAxis);

  /********************  render x坐标轴 ******************/

    // 定义x轴比例尺
  var xScale = d3.scaleLinear()
      .domain ([0, data.length])
      .range([0, dimensions.gInnerWidth]);

  var xAxis = d3.axisBottom(xScale)
    .tickValues(data.map((item,i) => i + 0.5))
  .tickFormat((d, i) => data[i].label); // 可以 格式化刻度值

  chart.append('g')
    .attr('transform', `translate(${dimensions.gMargin}, ${dimensions.gMargin + dimensions.gInnerHeight})`)
    .call(xAxis);

  /********************  render 矩形柱子 ******************/
  chart.append('g')
    .attr('transform', `translate(${dimensions.gMargin}, ${dimensions.gMargin})`)  // 偏移g元素
    .selectAll('rect')
    .data(data)
    .enter()
    .append('rect')
    .classed('bar-line', true)
    .attr('x', (d, i) => (dimensions.gInnerWidth / data.length) * i + dimensions.bMargin)
  .attr('y', (d, i) =>  dimensions.gInnerHeight - yScale(d.value))
  .attr('width', barWidth)
    .attr('height', (d, i) => yScale(d.value))
</script>
</body>
</html>